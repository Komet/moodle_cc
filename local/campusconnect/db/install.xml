<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="local/campusconnect/db" VERSION="20121212" COMMENT="XMLDB file for Moodle local/campusconnect"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <TABLE NAME="local_campusconnect_ecs" COMMENT="Settings for connecting to different ECS" NEXT="local_campusconnect_eventin">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="enabled"/>
        <FIELD NAME="enabled" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="1" SEQUENCE="false" COMMENT="Is this ECS currently active?" PREVIOUS="id" NEXT="name"/>
        <FIELD NAME="name" TYPE="text" LENGTH="small" NOTNULL="false" SEQUENCE="false" COMMENT="The local name used to identify this ECS" PREVIOUS="enabled" NEXT="url"/>
        <FIELD NAME="url" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The URL of the ECS" PREVIOUS="name" NEXT="auth"/>
        <FIELD NAME="auth" TYPE="int" LENGTH="3" NOTNULL="false" UNSIGNED="false" DEFAULT="2" SEQUENCE="false" COMMENT="The type of authentication to use (1 = none, 2 = http, 3 = certificate)" PREVIOUS="url" NEXT="ecsauth"/>
        <FIELD NAME="ecsauth" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The ecsauth name to add to the header when using no authentication" PREVIOUS="auth" NEXT="httpuser"/>
        <FIELD NAME="httpuser" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The username to use with basic http auth" PREVIOUS="ecsauth" NEXT="httppass"/>
        <FIELD NAME="httppass" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The password to use with basic http auth" PREVIOUS="httpuser" NEXT="cacertpath"/>
        <FIELD NAME="cacertpath" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The path to the CA certificate when using certificate authentication" PREVIOUS="httppass" NEXT="certpath"/>
        <FIELD NAME="certpath" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The certificate path to use with certificate authentication" PREVIOUS="cacertpath" NEXT="keypath"/>
        <FIELD NAME="keypath" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The path to the key file for use with certificate authentication." PREVIOUS="certpath" NEXT="keypass"/>
        <FIELD NAME="keypass" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The key password for use with certificate authentication." PREVIOUS="keypath" NEXT="crontime"/>
        <FIELD NAME="crontime" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="How often to check for updates from this ECS server (in seconds)" PREVIOUS="keypass" NEXT="lastcron"/>
        <FIELD NAME="lastcron" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="The last time we checked for updates from this ECS server" PREVIOUS="crontime" NEXT="importcategory"/>
        <FIELD NAME="importcategory" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The course category id to put imported courses into" PREVIOUS="lastcron" NEXT="importrole"/>
        <FIELD NAME="importrole" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="The shortname of the role to assign to incoming users" PREVIOUS="importcategory" NEXT="importperiod"/>
        <FIELD NAME="importperiod" TYPE="int" LENGTH="6" NOTNULL="false" UNSIGNED="false" DEFAULT="6" SEQUENCE="false" COMMENT="The number of months to keep imported users active" PREVIOUS="importrole" NEXT="notifyusers"/>
        <FIELD NAME="notifyusers" TYPE="text" LENGTH="medium" NOTNULL="false" SEQUENCE="false" COMMENT="Comma-separated list of email addresses to notify about new users via ECS" PREVIOUS="importperiod" NEXT="notifycontent"/>
        <FIELD NAME="notifycontent" TYPE="text" LENGTH="medium" NOTNULL="false" SEQUENCE="false" COMMENT="Comma-separated list of email addresses to notify about new external courses via ECS" PREVIOUS="notifyusers" NEXT="notifycourses"/>
        <FIELD NAME="notifycourses" TYPE="text" LENGTH="medium" NOTNULL="false" SEQUENCE="false" COMMENT="Comma-separated list of email addresses to notify about newly exported courses via ECS" PREVIOUS="notifycontent"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="importcategory"/>
        <KEY NAME="importcategory" TYPE="foreign" FIELDS="importcategory" REFTABLE="course_categories" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_eventin" COMMENT="Stores incoming events from the ECS server, until they have been processed" PREVIOUS="local_campusconnect_ecs" NEXT="local_campusconnect_clink">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="type"/>
        <FIELD NAME="type" TYPE="char" LENGTH="50" NOTNULL="false" SEQUENCE="false" COMMENT="The resource type the event is linked to" PREVIOUS="id" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the resource on the ECS server" PREVIOUS="type" NEXT="serverid"/>
        <FIELD NAME="serverid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ECS server this event came from" PREVIOUS="resourceid" NEXT="status"/>
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="false" SEQUENCE="false" COMMENT="The status of the event ('created', 'updated', 'destroyed', 'new_export')" PREVIOUS="serverid" NEXT="failcount"/>
        <FIELD NAME="failcount" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Counts how many times this message has failed to be processed" PREVIOUS="status"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="serverid"/>
        <KEY NAME="serverid" TYPE="foreign" FIELDS="serverid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_clink" COMMENT="Stores information about course links" PREVIOUS="local_campusconnect_eventin" NEXT="local_campusconnect_part">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="courseid"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the 'fake' course that will redirect to this link" PREVIOUS="id" NEXT="url"/>
        <FIELD NAME="url" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The external URL to redirect to" PREVIOUS="courseid" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of this course link on the ECS server" PREVIOUS="url" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the ECS server that this link came from" PREVIOUS="resourceid" NEXT="mid"/>
        <FIELD NAME="mid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The member ID of the site this course came from" PREVIOUS="ecsid"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="courseid"/>
        <KEY NAME="courseid" TYPE="foreign" FIELDS="courseid" REFTABLE="course" REFFIELDS="id" PREVIOUS="primary" NEXT="ecsid"/>
        <KEY NAME="ecsid" TYPE="foreign" FIELDS="ecsid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="courseid"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_part" COMMENT="Settings for participants in an ECS" PREVIOUS="local_campusconnect_clink" NEXT="local_campusconnect_mappings">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="ECS that this participant is found on" PREVIOUS="id" NEXT="mid"/>
        <FIELD NAME="mid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the participant in the community on the ECS server" PREVIOUS="ecsid" NEXT="export"/>
        <FIELD NAME="export" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Should courses be exported to this participant?" PREVIOUS="mid" NEXT="import"/>
        <FIELD NAME="import" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Should course be imported from this participant?" PREVIOUS="export" NEXT="importtype"/>
        <FIELD NAME="importtype" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="1" SEQUENCE="false" COMMENT="How to treat courses imported from this participant" PREVIOUS="import" NEXT="displayname"/>
        <FIELD NAME="displayname" TYPE="text" LENGTH="small" NOTNULL="false" SEQUENCE="false" PREVIOUS="importtype"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="ecsid"/>
        <KEY NAME="ecsid" TYPE="foreign" FIELDS="ecsid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="ecsid_mid" UNIQUE="true" FIELDS="ecsid, mid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="local_campusconnect_mappings" COMMENT="Stores the metadata mappings for each ECS course import/export" PREVIOUS="local_campusconnect_part" NEXT="local_campusconnect_export">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="field"/>
        <FIELD NAME="field" TYPE="char" LENGTH="50" NOTNULL="false" SEQUENCE="false" COMMENT="The destination field for the mapping" PREVIOUS="id" NEXT="setto"/>
        <FIELD NAME="setto" TYPE="text" LENGTH="small" NOTNULL="false" SEQUENCE="false" COMMENT="The field / string to set the destination field to" PREVIOUS="field" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ECS this mapping is associated with" PREVIOUS="setto" NEXT="type"/>
        <FIELD NAME="type" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The type of mapping (1 = import_course, 2 = import_external_course, 3 = export_course, 4 = export_external_course)" PREVIOUS="ecsid"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="ecsid"/>
        <KEY NAME="ecsid" TYPE="foreign" FIELDS="ecsid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_export" COMMENT="Details of the courses that are exported via the ECS" PREVIOUS="local_campusconnect_mappings" NEXT="local_campusconnect_dirroot">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="courseid"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The course being exported" PREVIOUS="id" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ECS being exported to" PREVIOUS="courseid" NEXT="mids"/>
        <FIELD NAME="mids" TYPE="text" LENGTH="small" NOTNULL="false" SEQUENCE="false" COMMENT="Comma-separated list of participant ids that this course is shared with" PREVIOUS="ecsid" NEXT="status"/>
        <FIELD NAME="status" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="What has happened to this export since the ECS was last informed (0 = nothing, 1 = created, 2 = updated, 3 = deleted)" PREVIOUS="mids" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the resource on the ECS server" PREVIOUS="status"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="courseid"/>
        <KEY NAME="courseid" TYPE="foreign" FIELDS="courseid" REFTABLE="course" REFFIELDS="id" PREVIOUS="primary" NEXT="ecsid"/>
        <KEY NAME="ecsid" TYPE="foreign" FIELDS="ecsid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="courseid"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_dirroot" COMMENT="Contains the root nodes of the directory trees passed on from the CMS via the ECS server." PREVIOUS="local_campusconnect_export" NEXT="local_campusconnect_dir">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the resource on the ECS server" PREVIOUS="id" NEXT="rootid"/>
        <FIELD NAME="rootid" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="The ID of the root node on the CMS" PREVIOUS="resourceid" NEXT="title"/>
        <FIELD NAME="title" TYPE="text" LENGTH="small" NOTNULL="true" SEQUENCE="false" COMMENT="The name of the directory node from the CMS" PREVIOUS="rootid" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the ECS that this resource came from" PREVIOUS="title" NEXT="mid"/>
        <FIELD NAME="mid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The participant this directory tree came from" PREVIOUS="ecsid" NEXT="categoryid"/>
        <FIELD NAME="categoryid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The Moodle category this directory tree is mapped on to (null for none)" PREVIOUS="mid" NEXT="mappingmode"/>
        <FIELD NAME="mappingmode" TYPE="int" LENGTH="4" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="The mapping mode of this tree (0 - pending, 1 - whole tree, 2 - manual mapping, 3 - deleted)" PREVIOUS="categoryid" NEXT="takeovertitle"/>
        <FIELD NAME="takeovertitle" TYPE="int" LENGTH="4" NOTNULL="true" UNSIGNED="false" DEFAULT="1" SEQUENCE="false" COMMENT="Should the directory tree take over the category title?" PREVIOUS="mappingmode" NEXT="takeoverposition"/>
        <FIELD NAME="takeoverposition" TYPE="int" LENGTH="4" NOTNULL="true" UNSIGNED="false" DEFAULT="1" SEQUENCE="false" COMMENT="Should directory tree take over the category sort order?" PREVIOUS="takeovertitle" NEXT="takeoverallocation"/>
        <FIELD NAME="takeoverallocation" TYPE="int" LENGTH="4" NOTNULL="true" UNSIGNED="false" DEFAULT="1" SEQUENCE="false" COMMENT="Should the tree take over directory allocations?" PREVIOUS="takeoverposition"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="ecsid"/>
        <KEY NAME="ecsid" TYPE="foreign" FIELDS="ecsid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="rootid" UNIQUE="true" FIELDS="rootid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="local_campusconnect_dir" COMMENT="A directory node from the CMS via the ECS server" PREVIOUS="local_campusconnect_dirroot" NEXT="local_campusconnect_crs">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the resource on the ECS server" PREVIOUS="id" NEXT="rootid"/>
        <FIELD NAME="rootid" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="The ID of the root of the directory tree" PREVIOUS="resourceid" NEXT="directoryid"/>
        <FIELD NAME="directoryid" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="The ID of the directory on the CMS" PREVIOUS="rootid" NEXT="title"/>
        <FIELD NAME="title" TYPE="text" LENGTH="small" NOTNULL="true" SEQUENCE="false" COMMENT="The title of the directory, from the CMS" PREVIOUS="directoryid" NEXT="parentid"/>
        <FIELD NAME="parentid" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="The directoryid of the parent directory" PREVIOUS="title" NEXT="sortorder"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Used to define the order in which directories should be displayed" PREVIOUS="parentid" NEXT="categoryid"/>
        <FIELD NAME="categoryid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The Moodle category this directory is mapped onto (null if not mapped)" PREVIOUS="sortorder" NEXT="mapping"/>
        <FIELD NAME="mapping" TYPE="int" LENGTH="4" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="The mapping mode (0 - automatic, 1 - manual, 2 - deleted)" PREVIOUS="categoryid"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="rootid" UNIQUE="false" FIELDS="rootid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="local_campusconnect_crs" COMMENT="Stores information about courses created by campusconnect" PREVIOUS="local_campusconnect_dir" NEXT="local_campusconnect_rolemap">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="courseid"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The ID of the course that has been created" PREVIOUS="id" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The resourceid on the ECS server" PREVIOUS="courseid" NEXT="cmsid"/>
        <FIELD NAME="cmsid" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The ID by which the course is known on the CMS" PREVIOUS="resourceid" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The ECS server this course came from" PREVIOUS="cmsid" NEXT="mid"/>
        <FIELD NAME="mid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The participant this course came from" PREVIOUS="ecsid" NEXT="internallink"/>
        <FIELD NAME="internallink" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Is this an internal link, or is it the 'real' course?" PREVIOUS="mid" NEXT="urlresourceid"/>
        <FIELD NAME="urlresourceid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="The resourceid for the course_url resource sent back to the ECS server" PREVIOUS="internallink" NEXT="urlstatus"/>
        <FIELD NAME="urlstatus" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Does the course_url need updating on the ECS server (0 = up to date; 1 = created; 2 = updated; 3 = deleted)" PREVIOUS="urlresourceid" NEXT="sortorder"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="The order in which courses should be displayed (if sortorder is specified)" PREVIOUS="urlstatus" NEXT="directoryid"/>
        <FIELD NAME="directoryid" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The CMS directoryid this course is allocated within" PREVIOUS="sortorder"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="courseid"/>
        <KEY NAME="courseid" TYPE="foreign-unique" FIELDS="courseid" REFTABLE="course" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_rolemap" COMMENT="Role mapping" PREVIOUS="local_campusconnect_crs" NEXT="local_campusconnect_mbr">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="ccrolename"/>
        <FIELD NAME="ccrolename" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" PREVIOUS="id" NEXT="moodleroleid"/>
        <FIELD NAME="moodleroleid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="true" SEQUENCE="false" PREVIOUS="ccrolename"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_mbr" COMMENT="Stored details of requested membership lists from the ECS" PREVIOUS="local_campusconnect_rolemap" NEXT="local_campusconnect_notify">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The resourceid for this membership list on the ECS" PREVIOUS="id" NEXT="cmscourseid"/>
        <FIELD NAME="cmscourseid" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The identifier by which the course is known on the CMS" PREVIOUS="resourceid" NEXT="personid"/>
        <FIELD NAME="personid" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The ID by which the user is known on the CMS" PREVIOUS="cmscourseid" NEXT="role"/>
        <FIELD NAME="role" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The role requested by the CMS" PREVIOUS="personid" NEXT="status"/>
        <FIELD NAME="status" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" SEQUENCE="false" COMMENT="The current status of the membership list request - role assigned (0), request created (1), updated (2), to be deleted (3)" PREVIOUS="role" NEXT="parallelgroups"/>
        <FIELD NAME="parallelgroups" TYPE="text" LENGTH="medium" NOTNULL="false" SEQUENCE="false" COMMENT="List of the parallel groups this user should be enrolled into" PREVIOUS="status"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="personid" UNIQUE="false" FIELDS="personid"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="local_campusconnect_notify" COMMENT="Stores a list of notifications to send out to users." PREVIOUS="local_campusconnect_mbr" NEXT="local_campusconnect_filter">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The ECS that this notification relates to" PREVIOUS="id" NEXT="type"/>
        <FIELD NAME="type" TYPE="int" LENGTH="4" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The type of notification to send out." PREVIOUS="ecsid" NEXT="subtype"/>
        <FIELD NAME="subtype" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="0 - create, 1 - update, 2 - delete resource" PREVIOUS="type" NEXT="data"/>
        <FIELD NAME="data" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="The ID of the relevant object to send information about" PREVIOUS="subtype" NEXT="extra"/>
        <FIELD NAME="extra" TYPE="text" LENGTH="medium" NOTNULL="false" SEQUENCE="false" COMMENT="An extra string to display beside the notification item" PREVIOUS="data"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="ecsid_type" UNIQUE="false" FIELDS="ecsid, type" COMMENT="Allows you to quickly get all the notifications of a particular type for an ECS"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="local_campusconnect_filter" COMMENT="Controls the mapping of imported courses onto categories" PREVIOUS="local_campusconnect_notify" NEXT="local_campusconnect_pgroup">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" SEQUENCE="true" NEXT="categoryid"/>
        <FIELD NAME="categoryid" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="false" SEQUENCE="false" COMMENT="The destination category for this mapping" PREVIOUS="id" NEXT="attribute"/>
        <FIELD NAME="attribute" TYPE="char" LENGTH="100" NOTNULL="true" SEQUENCE="false" COMMENT="The name of the attribute this mapping uses" PREVIOUS="categoryid" NEXT="words"/>
        <FIELD NAME="words" TYPE="text" LENGTH="medium" NOTNULL="false" SEQUENCE="false" COMMENT="Comma-separated list of words to filter by (blank to accept all words)." PREVIOUS="attribute" NEXT="createsubdirectories"/>
        <FIELD NAME="createsubdirectories" TYPE="int" LENGTH="4" NOTNULL="false" UNSIGNED="false" DEFAULT="0" SEQUENCE="false" COMMENT="Controls whether or not subdirectories should be created (named after the attribute values)" PREVIOUS="words"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="categoryid"/>
        <KEY NAME="categoryid" TYPE="foreign" FIELDS="categoryid" REFTABLE="category" REFFIELDS="id" PREVIOUS="primary"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="local_campusconnect_pgroup" COMMENT="Stores details of parallel groups for students to enrol in." PREVIOUS="local_campusconnect_filter">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true" NEXT="ecsid"/>
        <FIELD NAME="ecsid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="The ECS that this group came from" PREVIOUS="id" NEXT="resourceid"/>
        <FIELD NAME="resourceid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="The course resource that this group relates to" PREVIOUS="ecsid" NEXT="grouptitle"/>
        <FIELD NAME="grouptitle" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="The title of the group (from the CMS)" PREVIOUS="resourceid" NEXT="courseid"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="The course that the group belongs to" PREVIOUS="grouptitle" NEXT="groupid"/>
        <FIELD NAME="groupid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="The ID of the Moodle group this maps onto" PREVIOUS="courseid" NEXT="cmscourseid"/>
        <FIELD NAME="cmscourseid" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="The cms course this group is part of" PREVIOUS="groupid" NEXT="groupnum"/>
        <FIELD NAME="groupnum" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="The number of this group within the list of groups for the course" PREVIOUS="cmscourseid"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="ecsid"/>
        <KEY NAME="ecsid" TYPE="foreign" FIELDS="ecsid" REFTABLE="local_campusconnect_ecs" REFFIELDS="id" PREVIOUS="primary" NEXT="courseid"/>
        <KEY NAME="courseid" TYPE="foreign" FIELDS="courseid" REFTABLE="course" REFFIELDS="id" PREVIOUS="ecsid" NEXT="groupid"/>
        <KEY NAME="groupid" TYPE="foreign" FIELDS="groupid" REFTABLE="group" REFFIELDS="id" PREVIOUS="courseid"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="resourceid" UNIQUE="false" FIELDS="resourceid, ecsid" NEXT="cmscourseid"/>
        <INDEX NAME="cmscourseid" UNIQUE="false" FIELDS="cmscourseid" PREVIOUS="resourceid"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>